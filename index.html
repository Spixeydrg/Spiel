<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LifeSim Indie Edition</title>

<style>
:root{
    --bg:#0f0f14;
    --card:#1c1c24;
    --accent:#4aa3ff;
    --danger:#ff4a4a;
    --success:#4aff88;
}

body{
    margin:0;
    font-family:Arial, Helvetica, sans-serif;
    background:var(--bg);
    color:white;
}

.container{
    max-width:1000px;
    margin:auto;
    padding:20px;
}

.card{
    background:var(--card);
    padding:15px;
    border-radius:12px;
    margin-bottom:15px;
}

button{
    background:var(--accent);
    border:none;
    padding:8px 14px;
    margin:5px;
    border-radius:6px;
    cursor:pointer;
    color:white;
    transition:0.2s;
}
button:hover{
    transform:scale(1.05);
}

.statbar{
    height:14px;
    border-radius:6px;
    margin-bottom:6px;
}

#eventModal{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.7);
    display:none;
    align-items:center;
    justify-content:center;
}

.modalContent{
    background:var(--card);
    padding:20px;
    border-radius:12px;
    max-width:400px;
}
</style>
</head>
<body>

<div class="container">
    <h1>üåç LifeSim Indie Edition</h1>
    <div id="game"></div>
</div>

<div id="eventModal">
    <div class="modalContent">
        <h3 id="eventTitle"></h3>
        <p id="eventText"></p>
        <div id="eventChoices"></div>
    </div>
</div>

<script>
/* ==========================
   CORE GAME ENGINE
========================== */

class Player{
    constructor(name){
        this.name=name;
        this.age=0;
        this.health=80;
        this.happiness=80;
        this.intelligence=50;
        this.looks=50;
        this.money=1000;
        this.job="Arbeitslos";
        this.alive=true;
    }
}

class Game{
    constructor(){
        this.player=null;
        this.events=this.createEvents();
    }

    start(){
        const save=localStorage.getItem("lifeSimIndie");
        if(save){
            this.player=Object.assign(new Player(),JSON.parse(save));
        }else{
            const name=prompt("Name deiner Person?");
            this.player=new Player(name||"Alex");
            this.save();
        }
        this.render();
    }

    save(){
        localStorage.setItem("lifeSimIndie",JSON.stringify(this.player));
    }

    ageUp(){
        if(!this.player.alive)return;

        this.player.age++;

        if(this.player.age>75 && Math.random()<0.3){
            this.die("Altersschw√§che");
        }else{
            this.triggerRandomEvent();
        }

        this.limitStats();
        this.save();
        this.render();
    }

    limitStats(){
        for(let key of ["health","happiness","intelligence","looks"]){
            if(this.player[key]>100)this.player[key]=100;
            if(this.player[key]<0)this.player[key]=0;
        }
        if(this.player.health<=0){
            this.die("schlechter Gesundheit");
        }
    }

    die(reason){
        this.player.alive=false;
        alert(`${this.player.name} ist mit ${this.player.age} Jahren an ${reason} gestorben.`);
    }

    createEvents(){
        return [
            {
                title:"Du wurdest krank",
                text:"Du f√ºhlst dich schwach.",
                choices:[
                    {
                        text:"Zum Arzt gehen (-200‚Ç¨)",
                        effect:(p)=>{
                            p.money-=200;
                            p.health+=15;
                        }
                    },
                    {
                        text:"Ignorieren",
                        effect:(p)=>{
                            p.health-=20;
                        }
                    }
                ]
            },
            {
                title:"Du gewinnst im Lotto",
                text:"Unglaublich!",
                choices:[
                    {
                        text:"Feiern",
                        effect:(p)=>{
                            p.money+=5000;
                            p.happiness+=10;
                        }
                    }
                ]
            }
        ];
    }

    triggerRandomEvent(){
        const event=this.events[Math.floor(Math.random()*this.events.length)];
        this.showEvent(event);
    }

    showEvent(event){
        document.getElementById("eventTitle").innerText=event.title;
        document.getElementById("eventText").innerText=event.text;

        const choicesDiv=document.getElementById("eventChoices");
        choicesDiv.innerHTML="";

        event.choices.forEach(choice=>{
            const btn=document.createElement("button");
            btn.innerText=choice.text;
            btn.onclick=()=>{
                choice.effect(this.player);
                this.closeEvent();
                this.save();
                this.render();
            };
            choicesDiv.appendChild(btn);
        });

        document.getElementById("eventModal").style.display="flex";
    }

    closeEvent(){
        document.getElementById("eventModal").style.display="none";
    }

    statBar(value,color){
        return `<div class="statbar" style="width:${value}%;background:${color}"></div>`;
    }

    render(){
        const p=this.player;
        document.getElementById("game").innerHTML=`
        <div class="card">
            <h2>${p.name} (${p.age})</h2>
            <p>üí∞ ${p.money}‚Ç¨</p>
            <p>üíº ${p.job}</p>
        </div>

        <div class="card">
            ‚ù§Ô∏è ${this.statBar(p.health,"red")}
            üòä ${this.statBar(p.happiness,"yellow")}
            üß† ${this.statBar(p.intelligence,"blue")}
            üòé ${this.statBar(p.looks,"pink")}
        </div>

        <div class="card">
            ${p.alive ? 
                `<button onclick="game.ageUp()">N√§chstes Jahr</button>` :
                `<button onclick="localStorage.clear(); location.reload()">Neues Leben</button>`
            }
        </div>
        `;
    }
}

/* ==========================
   INIT
========================== */

const game=new Game();
game.start();
</script>

</body>
</html>
